<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Save Money - Save Environment</title>
    <link rel="shortcut icon" href="https://iili.io/K7oy8rl.jpg" type="image/x-icon">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500&family=Roboto:wght@500;700;900&display=swap" rel="stylesheet"> 

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
    <link href="css/custome_style.css" rel="stylesheet">

    <style>
/********** Template CSS **********/
:root {
    --primary: #32C36C;
    --light: #F6F7F8;
    --dark: #1A2A36;
}
/* ----------------------Enquiry Solar Site Survey Form Start------------------------ */
        /* SURVEY FORM CSS STYLING */
        .wishes_form{
          display: flex;
          justify-content: center;
        }
        .form-container {
            background-color: #f4eaea;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 450px;
            border-style: solid;
            border-width: 2px;
            border-color: darkmagenta;
        }
        h2 {
            text-align: center;
            color: blue;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #666;
            font-weight: 600;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box; /* Ensures padding doesn't affect width */
            font-size: 14px;
        }
        textarea {
            resize: vertical;
        }
        .wishes_button {
            width: 50%;
            padding: 12px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-left: 25%;
        }
        .wishes_button:hover {
            background-color: #218838;
        }
        .wishes_button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        #status {
            margin-top: 15px;
            text-align: center;
            font-size: 14px;
        }
        .success { color: green; }
        .error { color: red; }
/* ----------------------Enquiry Solar Site Survey Form Start------------------------ */
</style>
</head>

<body>
    <!-- Spinner Start -->
    <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <!-- Spinner End -->

    <!-- Topbar Start -->
    <div class="container-fluid bg-dark p-0">
        <div class="row gx-0 d-none d-lg-flex">
            <div class="col-lg-7 px-5 text-start">
                <div class="h-100 d-inline-flex align-items-center me-4">
                    <small class="fa fa-map-marker-alt text-primary me-2"></small>
                    <small>Mumbai</small>
                </div>
                <div class="h-100 d-inline-flex align-items-center">
                    <small class="far fa-clock text-primary me-2"></small>
                    <small>Mon - Sun : 09.00 AM - 09.00 PM</small>
                </div>
            </div>
            <div class="col-lg-5 px-5 text-end">
                <div class="h-100 d-inline-flex align-items-center me-4">
                    <small class="fa fa-phone-alt text-primary me-2"></small>
                    <small><a href="tel:+917058866337" target="_blank">+91 70588 663370</a></small>
                </div>
                <div class="h-100 d-inline-flex align-items-center mx-n2">
                    <a class="btn btn-square btn-link rounded-0 border-0 border-end border-secondary" href="#"><i class="fab fa-facebook-f"></i></a>
                    <a class="btn btn-square btn-link rounded-0 border-0 border-end border-secondary" href="#"><i class="fab fa-twitter"></i></a>
                    <a class="btn btn-square btn-link rounded-0 border-0 border-end border-secondary" href="https://www.youtube.com/@Gyanchand.Maurya"><i class="fab fa-youtube"></i></a>
                    <a class="btn btn-square btn-link rounded-0" href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
    </div>
    <!-- Topbar End -->

    <!-- Navbar Start -->
    <nav class="navbar navbar-expand-lg bg-white navbar-light sticky-top p-0">
        <a href="#" target="_blank"><div id="company_logo"></div></a>
        <a href="index.html" class="navbar-brand d-flex align-items-center border-end px-4 px-lg-5">
<!--     <h2 class="m-0"><span style="color:red;">SOLAR</span> <span style="color:blue;">SHAKTI</span></h2> -->
<!--     <a href="#" target="_blank"><div id="APN_logo"></div></a> -->
        </a>
        <button type="button" class="navbar-toggler me-4" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <div class="navbar-nav ms-auto p-4 p-lg-0">
                <a href="index.html" class="nav-item nav-link active">Home</a>
                <a href="about.html" class="nav-item nav-link">About</a>
                <a href="service.html" class="nav-item nav-link">Service</a>
                <a href="project.html" class="nav-item nav-link">Project</a>
                <div class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Utility</a>
                    <div class="dropdown-menu bg-light m-0">
                        <a href="https://partner.apnsolar.com/" target="_self" class="dropdown-item">Partner Login</a>
                        <a href="https://solarshakti.in/#calculator" target="_self" class="dropdown-item">Solar Projec Calculator</a>
                        <a href="https://solarshakti.in/utility.html" target="_self" class="dropdown-item">Public Utility Services</a>
                        <!-- <a href="https://mauryag.vercel.app/" target="_blank" class="dropdown-item">Investment Plan</a>
                        <a href="feature.html" class="dropdown-item">Feature</a>
                        <a href="quote.html" class="dropdown-item">Free Quote</a>
                        <a href="team.html" class="dropdown-item">Our Team</a>
                        <a href="testimonial.html" class="dropdown-item">Testimonial</a> -->
                    </div>
                </div>
                <a href="/#contactus" class="nav-item nav-link">Contact</a>
            </div>
            <a href="quote.html" class="btn btn-primary rounded-0 py-4 px-lg-5 d-none d-lg-block">Get A Quote<i class="fa fa-arrow-right ms-3"></i></a>
        </div>
    </nav>
    <!-- Navbar End -->

    <!-- ----------------------Wishes Form Start-------------------------- -->
    <div class="wishes_form" id="contactus">
    <div class="form-container">
        <h2>Wishes</h2>
        <form id="contactForm">
            <div class="form-group">
                <select id="wishes_type" name="wishes_type" required>
                    <option value="" disabled selected>Select Wishes Type</option>
                    <option value="Happy Birthday">Birthday</option>
                    <option value="Happy Marriage Anniversary">Marriage Anniversary</option>
                </select>
            </div>
            
            <div class="form-group">
                <!-- <label for="name">Name</label> -->
                <input type="text" id="name" name="name" placeholder="Enter Your Full Name" required>
            </div>

            <div class="form-group">
                <!-- <label for="email">Email</label> -->
                <input type="email" id="email" name="email" placeholder="Enter Your E-Mail" required>
            </div>

            <div class="form-group">
                <!-- <label for="email">Email</label> -->
                <input type="tel" id="tel" name="tel" placeholder="Enter Your Mobile Number" required>
            </div>

            <div class="form-group">
                <label for="date">Date of Birth / Marriage</label>
                <input type="date" id="date" name="date" placeholder="" required>
            </div>

            <!-- <div class="form-group">
                <input type="text" id="subject" name="subject" placeholder="Subject" required>
            </div> -->

            <div class="form-group">
                <!-- <label for="wishemessage">Message</label> -->
                <input type="text" id="wishemessage" name="wishemessage" placeholder="Your Wishes Message" required>
            </div>

            <!-- <div class="form-group">
                <select id="wishes_img" name="wishes_img" required>
                    <option value="" disabled selected>Select Wishes Image</option>
                    <option value="1CeBSjf7-bPWFiEVsp30KM47bHfM6R_0t">Birthday Image</option>
                    <option value="1Ev7sFritXenlCNYKnX64fruVrlVRKG9O">Marraige Anniversary Image</option>
                </select>
            </div> -->

            <div class="form-group">
                <!-- <label for="message">Message</label> -->
                <textarea id="message" name="message" rows="4" placeholder="Write any thing (optional)"></textarea>
            </div>

            <button class="wishes_button" type="submit" id="submitBtn">Submit Wishes</button>
            <div id="status"></div>
        </form>
    </div>
    </div>

    <script>
        // --- JAVASCRIPT LOGIC ---
        
        // PASTE YOUR GOOGLE APPS SCRIPT WEB APP URL HERE
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwt6gP-cZorNsF3ojbgrC1gLdzYiw-VFBpg_WlBoxilb3aSPALs9_83AuzTpmFwFxcd/exec'; 

        const form = document.forms['contactForm'];
        const submitBtn = document.getElementById('submitBtn');
        const statusTxt = document.getElementById('status');

        form.addEventListener('submit', e => {
            e.preventDefault();
            
            // 1. Change button state to loading
            submitBtn.disabled = true;
            submitBtn.innerHTML = "Sending...";
            statusTxt.innerHTML = "";

            // 2. Prepare data
            const formData = new FormData(form);

            // 3. Send data to Google Script
            fetch(scriptURL, { method: 'POST', body: formData})
                .then(response => {
                    // Reset Form
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = "Submit Inquiry";
                    statusTxt.innerHTML = "Thank you! Your details have been submitted. Our Executive will contact you shortly";
                    statusTxt.className = "success";
                    form.reset();
                })
                .catch(error => {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = "Submit Inquiry";
                    statusTxt.innerHTML = "Error! Something went wrong.";
                    statusTxt.className = "error";
                    console.error('Error!', error.message);
                });
        });
    </script>
    <!-- ----------------------Wishes Form End-------------------------- -->
    <br>
    <!-- Footer Start -->
    <div class="container-fluid bg-dark" data-wow-delay="0.1s">
            <div class="copyright">
                    <div>
                        <a href="https://mauryag.vercel.app" style="color:white;"> &copy; 2025 Maurya G Consultancy | All Right Reserved.</a>
                    </div>
            </div>
    </div>
    <!-- Footer End -->
    <br>

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square rounded-circle back-to-top"><i class="bi bi-arrow-up"></i></a>
    <a href="https://wa.me/919220973200" target="_blank"><div id="chat"></div> </a>
    

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/counterup/counterup.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="lib/isotope/isotope.pkgd.min.js"></script>
    <script src="lib/lightbox/js/lightbox.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>
</body>

</html>


<!-- // 1-------Send Wishes by checking condotion by Wishes Type Image ID Start-----------------
function sendFormattedWishes() {
  // const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Wishes");
  const data = sheet.getDataRange().getValues();
  const today = new Date();
  const currentMonth = today.getMonth() + 1;
  const currentDate = today.getDate();

  for (var i = 1; i < data.length; i++) {
    let type = data[i][1];      // Column B
    let name = data[i][2];      // Column C
    let email = data[i][3];     // Column D
    let dateVal = new Date(data[i][5]); // Column F
    let subject = data[i][6];   // Column G
    let message = data[i][7];   // Column H
    let imageFileId = data[i][8]; // Column I (The Image ID you added)

    if (dateVal.getMonth() + 1 === currentMonth && dateVal.getDate() === currentDate) {
      
      // --- NEW LOGIC: Select Image ID based on Column B ---
      let imageFileId = '';
      if (type === "Birthday") {
        imageFileId = '1CeBSjf7-bPWFiEVsp30KM47bHfM6R_0t';
      } else if (type === "Marriage Anniversary") {
        imageFileId = '1Ev7sFritXenlCNYKnX64fruVrlVRKG9O';
      }

      // Fetch the specific image blob for this row
      let imageBlob = DriveApp.getFileById(imageFileId).getBlob().setName("wishImage");
      // ----------------------------------------------------

      // HTML Formatting: Using <b> for bold and <br> for new lines
      let htmlBody = `
        <div style="font-family: Arial, sans-serif; color: #333;">
          <h2 style="color: #8B028F;">Happy ${type}!</h2>
          <p>Dear <b>${name}</b>,</p>
          <p><b style="color: #0008E0;">${message.replace(/\n/g, '<br>')}</b></p>
          <br>
          <img src="cid:wishBanner" style="width:100%; max-width:600px; border-radius:10px;" />
          <p>Best Regards,<br><b>Gyanchand Maurya</b><br><b>Mobile:</b>9220973200<br>www.solarshakti.in</p>
        </div>
      `;

      GmailApp.sendEmail(email, subject, "Please enable HTML to view this message.", {
        htmlBody: htmlBody,
        inlineImages: {
          wishBanner: imageBlob
        },
        cc: "solarshakti.in@gmail.com"
      });
    }
  }
}
// 1-------Send Wishes by checking condotion by Wishes Type Image ID End----------------- -->







<!-- // 2------------------------------Send Wishes by Column Image ID Start----------------------------------------------------------
function sendFormattedWishes() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Wishes");   //---Get Data by Sheet Name--- any one
//  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();           //---Get Data by Active Sheet ---
  const data = sheet.getDataRange().getValues();
  const today = new Date();
  const currentMonth = today.getMonth() + 1;
  const currentDate = today.getDate();

  for (var i = 1; i < data.length; i++) {
    let type = data[i][1];      // Column B
    let name = data[i][2];      // Column C
    let email = data[i][3];     // Column D
    let dateVal = new Date(data[i][5]); // Column F
    let subject = data[i][6];   // Column G
    let message = data[i][7];   // Column H
    let imageFileId = data[i][8]; // Column I (The Image ID you added)

    // Check if it's the right date and that an Image ID exists in Column H
    if (dateVal.getMonth() + 1 === currentMonth && dateVal.getDate() === currentDate) {
      
      // Attempt to fetch the image from Column H
      let imageBlob;
      try {
        if (imageFileId) {
          imageBlob = DriveApp.getFileById(imageFileId).getBlob().setName("wishImage");
        } else {
          // Skip if no image ID is provided for this row
          console.warn("No Image ID found for: " + name);
          continue; 
        }
      } catch (e) {
        console.error("Error fetching image for " + name + ": " + e.message);
        continue;
      }

      // HTML Body
      let htmlBody = `
        <div style="font-family: Arial, sans-serif; color: #333;">
          <h2 style="color: #8B028F;">Happy ${type}!</h2>
          <p>Dear <b>${name}</b>,</p>
          <p><b style="color: #0008E0;">${message.replace(/\n/g, '<br>')}</b></p>
          <br>
          <img src="cid:wishBanner" style="width:100%; max-width:600px; border-radius:10px;" />
          <p>Best Regards,<br><b>Gyanchand Maurya</b><br><b>Mobile:</b>9220973200<br>www.solarshakti.in<br>mauryag.vercel.app</p>
        </div>
      `;

      GmailApp.sendEmail(email, subject, "Please enable HTML to view this message.", {
        htmlBody: htmlBody,
        inlineImages: {
          wishBanner: imageBlob
        },
        bcc: "solarshakti.in@gmail.com"
      });
    }
  }
}
// 2------------------------------Send Wishes by Column Image ID End---------------------------------------------------------- -->




<!-- // 3 ------------------------------Send Wishes by Column Image ID Start--------------------------------------------------------
function sendFormattedWishes() {
  // const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Wishes");
  const data = sheet.getDataRange().getValues();
  const today = new Date();
  const currentMonth = today.getMonth() + 1;
  const currentDate = today.getDate();

  for (var i = 1; i < data.length; i++) {
    let type = data[i][1];      // Column B
    let name = data[i][2];      // Column C
    let email = data[i][3];     // Column D
    let dateVal = new Date(data[i][5]); // Column F
    let subject = data[i][1];   // Column G
    let message = data[i][7];   // Column H
    // let imageFileId = data[i][8]; // Column I (The Image ID you added)

    if (dateVal.getMonth() + 1 === currentMonth && dateVal.getDate() === currentDate) {
      
      // --- NEW LOGIC: Select Image ID based on Column B ---
      let imageFileId = '';
      if (type === "Happy Birthday") {
        imageFileId = '1CeBSjf7-bPWFiEVsp30KM47bHfM6R_0t';
      } else if (type === "Happy Marriage Anniversary") {
        imageFileId = '1Ev7sFritXenlCNYKnX64fruVrlVRKG9O';
      }

      // Fetch the specific image blob for this row
      let imageBlob = DriveApp.getFileById(imageFileId).getBlob().setName("wishImage");
      // ----------------------------------------------------

      // -------------HTML Body Message Formatting: Start----------
      let htmlBody = `
        <div style="background-color: #f4f4f4; padding: 20px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
          <table align="center" border="0" cellpadding="0" cellspacing="0" width="100%" style="max-width: 600px; background-color: #ffffff; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            
            <tr>
              <td style="padding: 40px 30px;">
                <h2 style="color: #9D13D4; margin-top: 0; font-size: 24px;"> ${type}! <br> Dear ${name},</h2>                
                <p style="font-size: 16px; line-height: 1.6; color: #000BBD;">
                  ${message.replace(/\n/g, '<br>')}
                </p>
              </td>
            </tr>

            <tr>
              <td style="padding: 0;">
                <img src="cid:wishBanner" alt="Wishes" style="width: 100%; display: block; border-bottom: 4px solid #16B300;" />
              </td>
            </tr>
            <br>

            <tr>
              <td style="padding: 20px 30px; background-color: #f9f9f9; border-top: 1px solid #eeeeee;">
                <table border="0" cellpadding="0" cellspacing="0" width="100%">
                  <tr>
                    <td>
                      <p style="margin: 0; font-size: 14px; color: #333;">Best Regards,</p>
                      <p style="margin: 5px 0 0 0; font-size: 16px; color: #16B300; font-weight: bold;">Gyanchand Maurya</p>
                      <p style="margin: 0; font-size: 13px; color: #666;">
                        <strong>Mobile:</strong> <a href="tel:+919220973200" style="text-decoration: none; color: #16B300;">9220973200</a><br>
                        <a href="https://solarshakti.in" style="text-decoration: none; color: #16B300; font-weight: 500;">www.solarshakti.in</a>
                      </p>
                    </td>
                  </tr>
                </table>
              </td>
            </tr>
          </table>
          
          <table align="center" border="0" cellpadding="0" cellspacing="0" width="100%" style="max-width: 600px;">
            <tr>
              <td style="padding: 20px; text-align: center; font-size: 12px; color: #999;">
                Â© ${new Date().getFullYear()} Solar Shakti. All rights reserved.
              </td>
            </tr>
          </table>
        </div>
      `;
      // -------------HTML Body Message Formatting: End----------

      GmailApp.sendEmail(email, subject, "Please enable HTML to view this message.", {
        htmlBody: htmlBody,
        inlineImages: {
          wishBanner: imageBlob
        },
        bcc: "solarshakti.in@gmail.com"
      });
    }
  }
}
// 3 ------------------------------Send Wishes by Column Image ID End---------------------------------------------------------- -->